version: 1

defaults:
  tone: concise
  tests_required: true
  conventional_commits: true
  model: gpt-4o

targets:
  repoRoot: '.'
  githubDir: '.github'
  vscodeDir: '.vscode'

snippetRoots:
  - 'docs_library/snippets/copilot'

vars:
  project_name: 'co-pilot_rocket'
  org_style: 'minimal'
  ci_command: 'pnpm test && pnpm lint'
  risk_section: true
  tone: 'concise'

github:
  repowide:
    - from: 'repowide/copilot-instructions.md'
      to: 'copilot-instructions.md'
    - from: 'agents/AGENTS.md'
      to: 'AGENTS.md'

  instructions:
    - from: 'instructions/frontend.md'
      to: 'instructions/frontend.instructions.md'
      meta:
        applyTo:
          - 'apps/web/**'
          - '**/*.tsx'
    - from: 'instructions/backend.md'
      to: 'instructions/backend.instructions.md'
      meta:
        applyTo:
          - 'apps/api/**'
          - '**/*.ts'
    - from: 'instructions/docs.md'
      to: 'instructions/docs.instructions.md'
      meta:
        applyTo:
          - 'docs/**'
          - '**/*.md'
    - from: 'instructions/tests.md'
      to: 'instructions/tests.instructions.md'
      meta:
        applyTo:
          - '**/*.{spec,test}.{ts,tsx,dart,py}'
    - from: 'instructions/security.md'
      to: 'instructions/security.instructions.md'
      meta:
        applyTo:
          - '**/*'

  prompts:
    - from: 'prompts/code-review.md'
      to: 'prompts/code-review.prompt.md'
    - from: 'prompts/pr-description.md'
      to: 'prompts/pr-description.prompt.md'
    - from: 'prompts/generate-component.md'
      to: 'prompts/generate-component.prompt.md'
    - from: 'prompts/test-scaffold.md'
      to: 'prompts/test-scaffold.prompt.md'
    - from: 'prompts/refactor.md'
      to: 'prompts/refactor.prompt.md'
    - from: 'prompts/docs-rewrite.md'
      to: 'prompts/docs-rewrite.prompt.md'
    - from: 'prompts/security-scan.md'
      to: 'prompts/security-scan.prompt.md'

  chatmodes:
    - from: 'chatmodes/planner.md'
      to: 'chatmodes/planner.chatmode.md'
      meta:
        model: '{{model}}'
        tools: ['codebase', 'search', 'githubRepo']
    - from: 'chatmodes/strict-reviewer.md'
      to: 'chatmodes/strict-reviewer.chatmode.md'
    - from: 'chatmodes/rapid-editor.md'
      to: 'chatmodes/rapid-editor.chatmode.md'
    - from: 'chatmodes/research.md'
      to: 'chatmodes/research.chatmode.md'

vscode:
  createIfMissing: true
  settings:
    chat.promptFiles: true
    github.copilot.inlineSuggest.enable: true
    github.copilot.editor.enableAutoCompletions: true
    github.copilot.chat.enable: true
    github.copilot.chat.citations.enabled: true
    github.copilot.chat.searchScope: 'workspace'
    github.copilot.chat.pullRequestDescriptionGeneration.instructions:
      - text: 'Use Conventional Commits; include Context, Changes, Risks, Rollback, Test Plan.'
      - file: '.github/prompts/pr-description.prompt.md'
    github.copilot.chat.reviewSelection.instructions:
      - file: '.github/prompts/code-review.prompt.md'
      - text: 'Be strict on security, tests, API compatibility.'
    github.copilot.chat.promptFiles:
      - '.github/prompts/generate-component.prompt.md'
      - '.github/prompts/test-scaffold.prompt.md'
      - '.github/prompts/refactor.prompt.md'
      - '.github/prompts/docs-rewrite.prompt.md'
      - '.github/prompts/security-scan.prompt.md'
    github.copilot.chat.customModes:
      - '.github/chatmodes/planner.chatmode.md'
      - '.github/chatmodes/strict-reviewer.chatmode.md'
      - '.github/chatmodes/rapid-editor.chatmode.md'
      - '.github/chatmodes/research.chatmode.md'
    github.copilot.chat.fileContext.includeGlobs:
      - 'apps/**'
      - 'packages/**'
      - 'libs/**'
      - 'src/**'
      - 'docs/**'
    github.copilot.chat.fileContext.excludeGlobs:
      - '**/node_modules/**'
      - '**/.next/**'
      - '**/build/**'
      - '**/dist/**'
      - '**/.venv/**'
      - '**/.dart_tool/**'
      - '**/coverage/**'
    editor.formatOnSave: true
    editor.codeActionsOnSave:
      source.fixAll: 'explicit'
      source.organizeImports: 'explicit'
    files.eol: "\n"
    files.insertFinalNewline: true
    files.trimTrailingWhitespace: true
    telemetry.telemetryLevel: 'off'
    extensions.recommendations:
      - 'github.copilot'
      - 'github.copilot-chat'
      - 'dbaeumer.vscode-eslint'
      - 'esbenp.prettier-vscode'
      - 'ms-python.python'
      - 'dart-code.dart-code'
      - 'dart-code.flutter'
